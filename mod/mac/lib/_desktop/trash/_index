# shellcheck shell=dash

___x_cmd_mac_trash(){
    [ "$#" -gt 0 ] || set -- ls

    local op="$1";  shift
    case "$op" in
        ls|empty|size)
            ___x_cmd_mac_trash_"$op" "$@"   ;;
        -h|--help)
            ___x_cmd help -m mac trash      ;;
    esac
}

___x_cmd_mac_trash___isallow(){
    # Notice: apple not allowed shell to access Trash folder by default for security.
    [ -r "$HOME/.Trash" ] || \
        N=mac M="Not allow to read/modify trash folder in the shell out of security concerns. If you want to grant permission, try 'x mac trash allow'" log:ret:1
}

___x_cmd_mac_trash_allow(){
    mac:info "Sorry, currently we fail to implement this function -> "___x_cmd_mac_trash_allow
    return 1
}

# TODO: using Finder to empty folder
___x_cmd_mac_trash_empty(){
    ___x_cmd_mac_trash___isallow || {
        # open trash folder
        mac:info "Cannot access $HOME/.trash, so we start the recycle app to show files in the trash."
        ___x_cmd open "$HOME/.trash"
        return
    }

    sudo rm -rf ~/.Trash/*
    # osascript -e 'tell application "Finder" to empty trash'
}

# TODO: using Finder
___x_cmd_mac_trash_size(){
    ___x_cmd_mac_trash___isallow || {
        # open trash folder
        ___x_cmd open "$HOME/.trash"
        return
    }
    ___x_cmd_cmds du -sH ~/.Trash/
}

# TODO: using Finder
___x_cmd_mac_trash_ls(){
    ___x_cmd_mac_trash___isallow || {
        # open trash folder
        ___x_cmd open "$HOME/.trash"
        return
    }
    ___x_cmd_cmds ls -alh ~/.Trash/
}
